---
layout: post
title: ECMAScript 6 e os novos let e const
date: 2014-11-12 18:02:35.000000000 -02:00
type: post
published: true
status: publish
categories:
- Blog
tags: []
meta:
  _edit_last: '1'
author:
  login: afonsof
  email: afonso.franca@gmail.com
  display_name: admin
  first_name: ''
  last_name: ''
---
<p>O ECMAScript 6 vem chegando e existem diversas novas modificações que tornarão a linguagem Javascript mais robusta<br />
e mais preparada para o nosso tempo. Duas das novas funcionalidades são as palavras-chave <code>let</code> e <code>const</code>.<!--more--></p>
<h3>let</h3>
<p>Até o ECMAScript 5, no JavaScript existiam apenas dois tipos de escopo, o escopo da função e o escopo global. Isto<br />
causava muita frustração e comportamentos inesperados para pessoas que utilizavam anteriormente outras linguagens, como<br />
C, C++, C# e Java.</p>
<p>O motivo é que o JavaScript até então não tinha um escopo de bloco e com ele espera-se que uma variável deva existir e<br />
ser acessível apenas dentro do bloco que ela for definida. Um bloco é tudo que está envolvido dentro das chaves em<br />
JavaScript. No exemplo abaixo podemos ter uma ideia do que o escopo de bloco significaria:</p>
<pre><code class="language-javascript">...
if (true) {
    var value = "ok";
    console.log(value); // imprime ok
}
console.log(value); // imprime ok mas não deveria
...</code></pre>
<p>Na saída da execução deste código teríamos:</p>
<pre><code>ok
ok</code></pre>
<p>Se pensássemos de forma "não-javascript" esperaríamos que fora do bloco <code>if</code> não se possa acessar a variável<br />
<code>value</code>. Por exemplo, executando um código equivalente a esse em C# ele nem compilaria, pois o<br />
compilador avisaria que o código estava tentando utilizar uma variável fora do seu escopo. Mas no JavaScript isto é<br />
possível e o comportamento é estranho.</p>
<p>Com o ECMAScript 6 finalmente teremos os escopo de bloco. O pessoal da organização ECMA sabiam que eles não seria<br />
possível mudar o comportamento da palavra <code>var</code> por questões de compatibilidade retroativa. Então<br />
eles decidiram criar uma nova chamada <code>let</code>. Ela poderá ser usada para definir variáveis de escopo para<br />
serem usadas apenas dentro do bloco que elas foram declaradas.</p>
<p>Para explicar por que você deve aguardar ansiosamente pelo <code>let</code>vamos entender um exemplo. Imagine que você precise<br />
fazer um código que te retorne um array de 10 funções. Cada uma das funções deve lhe retornar o seu número de ordem.<br />
Por exemplo a 1ª função do array deve retornar <code>1</code> enquanto a nª função deve retornar <code>n</code>. Geralmente tendemos<br />
a fazer isto:</p>
<pre><code class="language-javascript">var arr = [];
for (var i = 0; i &lt; 10; i++) {
   arr.push(function(){ return i });
}</code></pre>
<p>Então podemos reconhecer claramente o problema de escopo. No exemplo acima a variável <code>i</code> assume o escopo<br />
global. Logo todas as funções do array retornarão <code>10</code>.</p>
<p>Ruim né? Mas o <code>let</code> pode resolver este problema!</p>
<pre><code class="language-javascript">var arr = [];
for (var i = 0; i &lt; 10; i++) {
   let j = i;
   arr.push(function(){ return j });
}</code></pre>
<p>Muito bom! Problema resolvido!</p>
<p>E quando podemos começar a usar esta funcionalidade? Infelizmente ainda não existe nenhum browser do mercado que<br />
a implemente, mas existem alguns compiladores de JavaScript como o compilador de templates<br />
<a href="https://github.com/tj/ejs">EJS</a> que já implementa completamente o <code>let</code>. A partir do Chrome 38 você pode<br />
utilizar a palavra-chave parcialmente através da ativação da flag "Funcionalidades Experimentais de JavaScript".</p>
<h3>const</h3>
<p>Já a palavra-chave <code>const</code> terá um funcionamento similar à mesma nas outras linguagens, ou seja, a associação de<br />
um valor a um nome e este valor jamais poderá ser alterado.</p>
<p>Esta abordagem é bastante válida se considerarmos a criação de constantes matemáticas como a definição do<br />
valor de pi, a constante de gravidade ou outra coisa do tipo.</p>
<p>As constantes funcionam como o <code>let</code>, isto quer dizer que dentro do mesmo escopo de bloco também não podem ser<br />
redeclaradas e não tem valiade fora dele.</p>
<p>Por enquanto o único browser que implementa completamente a palavra-chave <code>const</code> é o IE11, porém isto não quer<br />
dizer que não funciona em alguns outros browsers. No Chrome por exemplo ainda falta eles implementarem o tratamento<br />
para redefinição de uma constante e o escopo por bloco, mas já é possível fazer alguns testes.</p>
<p>Para maiores informações de como está a compatibilidade dos browsers para estas novas funcionalidades visite<br />
<a href="http://kangax.github.io/compat-table/es6">http://kangax.github.io/compat-table/es6</a></p>
